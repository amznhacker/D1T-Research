# Unitree D1 Bring-Up — 2025-12-23

## Session Metadata

- Date: 2025-12-23
- Start time: 20:30
- End time: 22:14
- Duration: ~1h44m
- Location: Merced Robotics lab
- System: Linux PC + Unitree D1
- Interface: USB-C → Ethernet adapter
- Goal: First deterministic motion + telemetry

---

## Initial Assumption (Incorrect)

> If Ethernet is plugged in and ping works, control should work.

This assumption turned out to be false.

---

## Power Model Observed

- The Unitree D1 has **no power button**
- Power ON = apply DC power
- Power OFF = remove DC power

This produces:
- deterministic boot
- no soft states
- delayed network and DDS readiness

---

## 20:30–20:45 — Initial Connectivity

```bash
ping 192.168.123.100
```

Ping succeeded.

This was later discovered to be misleading.

## 20:46 — Routing Check (Critical Discovery)

```bash
ip route get 192.168.123.100
```

Observed (incorrect):

```
dev lo src 192.168.123.100
```

Interpretation:

- Host had same IP as robot
- Linux routed traffic to loopback
- Ping was to self, not robot

## Root Cause Identified

- Robot factory IP: 192.168.123.100/24
- Host Ethernet adapter had temporarily acquired the same IP
- NetworkManager later re-applied that identity
- DDS traffic never left the host
- No error was raised.

## 21:00 — Host Identity Correction

Removed cached Ethernet profile:

```bash
nmcli connection delete "Wired connection 1"
```

Created explicit robot NIC profile:

```bash
nmcli connection add type ethernet \
  ifname enx4cea4168e514 \
  con-name d1-robot \
  ipv4.method manual \
  ipv4.addresses 192.168.123.10/24 \
  ipv6.method ignore
```

Activated profile:

```bash
nmcli connection up d1-robot
```

Verified:

```bash
ip addr show enx4cea4168e514
```

Confirmed:

```
inet 192.168.123.10/24
```

## 21:05 — Routing Verification

```bash
ip route get 192.168.123.100
```

Confirmed correct:

```
192.168.123.100 dev enx4cea4168e514 src 192.168.123.10
```

## 21:10 — Robot Firmware Verification

```bash
ssh ubuntu@192.168.123.100
```

Checked services:

```bash
systemctl status marm_communication.service
systemctl status marm_control.service
systemctl status marm_controller.service
systemctl status marm_subscripber.service
```

All services active and running.

Conclusion:
Robot firmware was never the problem.

## 21:20 — DDS Binding (Host Side)

Exported DDS interface:

```bash
export UNITREE_NETWORK_INTERFACE=enx4cea4168e514
```

Reason:
DDS otherwise enumerates all NICs and may silently select Wi-Fi or loopback.

**Helper Script Created:**

To avoid re-exporting on every session, created `run_d1.sh`:

```bash
#!/usr/bin/env bash
export UNITREE_NETWORK_INTERFACE=enx4cea4168e514
exec "$@"
```

Usage:
```bash
../../run_d1.sh ./arm_zero_control
../../run_d1.sh ./get_arm_joint_angle
../../run_d1.sh ./joint_enable_control
```

## 21:30 — SDK Build

```bash
cd d1_sdk
mkdir -p build
cd build
cmake ..
make -j$(nproc)
```

Build succeeded.

Executables produced:

- `joint_enable_control`
- `arm_zero_control`
- `get_arm_joint_angle`

## 21:40 — First Attempt at Telemetry

```bash
../../run_d1.sh ./get_arm_joint_angle
```

Observed:

- No output for ~30–40 seconds
- No error messages

Interpretation (initial):

- Suspected failure

Interpretation (correct):

- DDS discovery not yet stabilized
- Waited.

## 21:42 — Telemetry Begins

Output observed:

```
servo0_data:0.9
servo1_data:0.4
servo2_data:0.4
servo3_data:0
servo4_data:81.1
servo5_data:-0.3
servo6_data:0
```

Update rate ~10 Hz.

## 21:45 — Motor Enable

```bash
../../run_d1.sh ./joint_enable_control
```

Observed:

- No terminal output
- Arm became stiff

## 21:47 — Zero Motion

```bash
../../run_d1.sh ./arm_zero_control
```

Observed:

- Physical motion
- Arm returned to mechanical zero pose

## Final State (22:14)

System confirmed operational:

- Deterministic Ethernet link
- No IP collision
- Correct routing + source IP
- DDS discovery complete
- Motors enabled
- Live joint telemetry confirmed

Bring-up successful.

## Key Lesson

Silence does not imply failure.

In industrial systems:

- correctness is prioritized over feedback
- patience is part of operation

